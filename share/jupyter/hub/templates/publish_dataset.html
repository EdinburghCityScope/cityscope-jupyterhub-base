{% extends "page.html" %}
{% block main %}

<div class="container">


    {% if messages %}
    <div class="panel panel-default">
            <div class="{{message_class}}" style="padding:5px;">
                <p><strong>{% if message_class == 'bg-success' %}Success{% elif message_class == 'bg-danger' %}Error{% endif %}</strong></p>
                <ul>
                  {% for message in messages %}
                    <li>{{ message|safe }}</li>
                  {% endfor %}
                </ul>
            </div>
    </div>
    <div class="clearfix">&nbsp;</div>
    {% endif %}
{% if show_form %}
<h2>Creating files for publication for dataset: {{dataset_name}}</h2>
<p>This form creates the required Digital Catalogue (data.json) file, based on the contents of your dataset, and a default "Read Me" (README.md) file in the root of your dataset. These files are needed for publication to GitHub. Please note - the README.md file is never overwritten if it already exists but you can edit it manually.</p>
<p>If your data is complete and ready to be published as an Open Dataset on the <a href="https://github.com/EdinburghCityScope" target="_blank">EdinburghCityScope Github repository</a> (link opens in a new window) then please complete the details in the form below.<br/>
    The first section is concerned with the dataset as a whole, the second section is looking for information about the inidividual data files contained in the dataset.</br>
    Be aware that publishing your dataset as an opendata repository has a legal implication so please check <a href="#guidance">the brief guidance notes below</a></<br/>
</p>
<div class="panel panel-default">
    <div class="panel-body">
        <div class="panel panel-default">
            <div class="panel-heading">Overall information about dataset: <strong>{{dataset_name}}</strong> </div>
            <div class="panel-body">

            <form action="{{base_url}}publish-dataset/{{dataset_name}}" method="post">
                <div class="form-group {{form_fields['title']['css_class']}}">
    			    <label class="control-label" for="title">Title</label>
    			    <input type="text" class="form-control" name="title" id="title" value="{{form_fields['title']['value']}}"/>
                </div>
                <div class="form-group {{form_fields['description']['css_class']}}">
                    <label class="control-label" for="description">Description</label>
                    <textarea name="description" class="form-control" id="description" placeholder="Please decribe your dataset">{{form_fields['description']['value']}}</textarea>
                </div>
                <div class="form-group {{form_fields['publisher']['css_class']}}">
                    <label class="control-label" for="publisher">Publisher</label>
    			    <input type="text" class="form-control" name="publisher" id="publisher" value="{{form_fields['publisher']['value']}}"/>
                </div>
                <div class="form-group {{form_fields['email']['css_class']}}">
                    <label class="control-label" for="email">Email address</label>
    			    <input type="text" class="form-control" name="email" id="email" value="{{form_fields['email']['value']}}"/>
                </div>
                <div class="form-group {{form_fields['keywords']['css_class']}}">
                    <label class="control-label" for="keywords">Keywords</label>
    			    <input type="text" class="form-control" name="keywords" id="keywords" value="{{form_fields['keywords']['value']}}" aria-describedby="keyword_help"/>
                    <span id="keyword_help" class="help-block">{{form_fields['keywords']['help_text']}}</span>
                    <span class="help-block"></span>
                </div>


            </div><!-- close panel body -->
            </div><!-- close panel -->
            <!-- DATA FILES -->
            <h3>Tell us about your data files:</h3>
            {% for file in form_fields['distribution'] %}
            <div class="panel panel-default">
                <div class="panel-heading">Tell us about the file <strong>{{file['file_name']}} ({{file['mimetype']}})</strong></div>
                <div class="panel-body">
                    <div class="form-group {{file['title']['css_class']}}">
                      <label class="control-label" for="title">Title</label>
                      <input type="text" class="form-control" name="{{file['title']['name']}}" id="title" value="{{file['title']['value']}}"/>
                    </div>
                    <div class="form-group {{file['description']['css_class']}}">
                      <label class="control-label" for="description">Description</label>
                      <textarea name="{{file['description']['name']}}" class="form-control" id="description"
                        placeholder="Please decribe what data is contained in this file.">{{file['description']['value']}}</textarea>
                    </div>
                    <div class="form-group {{file['license']['css_class']}}">
                      <label class="control-label" for="license">License</label>
                      <input type="text" class="form-control" name="{{file['license']['name']}}" id="license" placeholder="eg: Open Data Commons Public Domain Dedication and License (PDDL)" value="{{file['license']['value']}}"/>
                      <span class="help-block">See <a href="http://opendatacommons.org/licenses/" target="_blank">Open Data License types</a> or <a href="https://data.gov.uk/terms-and-conditions" target="_blank">Open Government Licence</a> for help (each link opens in a new window)</span>
                    </div>
                </div>
            </div>
            {% endfor %}


<!-- http://www.openstreetmap.org/relation/1920901#map=11/55.9196/-3.2262 -->

                    <span id="errorBlock" class="help-block">
                        {% if error_message %}
                            <ul>
                              {% for errMsg in error_message %}
                                  <li>{{errMsg}}</li>
                              {% endfor %}
                            </ul>
                        {% endif %}
                    </span>


            <a href="{{base_url}}home" class="btn btn-default" role="button">Cancel</a>
            <input type="submit" class="btn btn-primary" id="PublishDataButton" value="Publish" />
        </form>

</div><!-- close panel body -->
</div><!-- close panel -->

<div class="clearfix">&nbsp;</div>

<div class="panel panel-default">
    <div class="panel-heading"><h3 id="guidance" name="guidance">Some brief guidance on open data</h3></div>
    <div class="panel-body">
        <h4>Open Data should be...</h4>
        <ul>
            <li>data should be provided without limitations based on user identity or intent</li>
            <li>free of restriction on use or redistribution in its licensing conditions</li>
            <li>should be anonymised so that no individual can be identified</li>
            <li>use a non-proprietary format (e.g. <abbr title="Comma Separated Value">csv</abbr> instead of Excel)</li>
            <li>data in the repository should be clearly documented to ease understanding</li>
            <li>people should be able to easily contribute new data, or request amendments to existing open data</li>
            <li>data owners, creators should be clearly stated</li>
            <li>data provenance should be clearly stated</li>

        </ul>
        <h4>Open Data should NOT ...</h4>
        <ul>
            <li>contain copyright, copyright pending, or be derived from copyright protected material</li>
            <li>contain patented, patent pending, or be derived from patent protected material</li>
            <li>contain data that could put people or organisations at risk</li>
            <li>contain data that would deliberately cause public offence</li>
        </ul>

        <p><strong>Further reading:</strong> (all the links below open in a new browser window)</p>
        <ul>
            <li><a href="https://en.wikipedia.org/wiki/Open_data" target="_blank">Wikipedia - Open Data</a></li>
            <li><a href="https://www.gov.uk/service-manual/technology/open-data.html" target="_blank"><abbr title="United Kingdom">UK</abbr> Government Open Data Policy</a></li>
            <li><a href="http://opendefinition.org/" target="_blank">The Open Definition of data and content</a></li>
            <li><a href="http://opendefinition.org/licenses/" target="_blank">Open Data Licenses</a></li>
        </ul>

    </div>
</div>
{% endif %}

</div><!--- close container -->

{% endblock %}
{% block script %}
<script type="text/javascript">
require(["dataupload"]);
</script>
{% endblock %}
